generator client {
    provider = "prisma-client-js"
    output   = "../generated/entity"
}

datasource db {
    provider = "postgresql"
    url      = env("ENTITY_DATABASE_URL")
}

model Entity {
    id String @id @default(uuid())

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    usernames          EntityUsername[]
    farcasterAccounts  EntityFarcaster[]
    blockchainAccounts EntityBlockchain[]
}

model EntityFarcaster {
    fid         String  @id
    entityId    String
    username    String?
    bio         String?
    pfp         String?
    displayName String?
    url         String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    entity Entity @relation(fields: [entityId], references: [id])
}

model EntityUsername {
    username String
    service  String
    entityId String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    entity Entity @relation(fields: [entityId], references: [id])

    @@id([username, service])
}

model EntityBlockchain {
    protocol   String
    address    String
    isContract Boolean
    entityId   String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    entity Entity @relation(fields: [entityId], references: [id])

    @@id([protocol, address])
}
