generator client {
    provider = "prisma-client-js"
    output   = "../generated/content"
}

datasource db {
    provider = "postgresql"
    url      = env("CONTENT_DATABASE_URL")
}

model FarcasterContentReference {
    fid        BigInt
    hash       String
    parentFid  BigInt?
    parentHash String?
    parentUrl  String?
    uri        String
    type       String // embed, reply, quote

    timestamp DateTime

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@id([uri, fid, hash, type])
    @@index([timestamp, type])
}

model UrlContent {
    uri      String  @id
    protocol String?
    host     String?
    path     String?
    query    String?
    fragment String?
    type     String?
    length   Int?
    metadata Json?
    hasFrame Boolean @default(false)
    frame    Json?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([type])
}
